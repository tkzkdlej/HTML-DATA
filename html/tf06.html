<!DOCTYPE html>
<html>
 
<head>
    <title>TensorFlow.js Tutorial - boston housing</title>
 
    <!-- Import TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
    <script >
var 상품데이터_원인 = [
[1,0,0,0,1,22],
[0,1,0,0,0,22],
[1,0,0,0,1,23],
[1,0,0,0,1,20],
[1,0,0,0,0,25],
[1,0,0,0,0,24],
[1,0,0,0,0,22],
[0,1,0,0,1,21],
[1,0,0,0,1,27],
[1,0,0,0,0,35],
[1,0,0,0,1,26],
[1,0,0,0,1,22],
[1,0,0,0,0,24],
[1,0,0,0,1,30],
[1,0,0,0,1,21],
[0,1,0,0,0,26],
[1,0,0,0,1,22],
[0,1,0,0,1,32],
[0,0,1,0,0,33],
[0,1,0,0,1,35],
[0,1,0,0,1,34],
[0,1,0,0,0,29],
[0,1,0,0,0,26],
[0,1,0,0,0,40],
[0,1,0,0,1,33],
[0,1,0,0,1,35],
[0,1,0,0,0,33],
[1,0,0,0,1,30],
[0,1,0,0,1,31],
[0,1,0,0,0,32],
[0,0,1,0,1,33],
[0,1,0,0,1,37],
[0,1,0,0,0,42],
[1,0,0,0,1,28],
[0,0,1,0,1,20],
[0,0,1,0,0,19],
[0,1,0,0,1,22],
[0,0,1,0,1,24],
[0,0,1,0,0,20],
[0,0,1,0,0,17],
[0,0,1,0,0,21],
[0,0,1,0,1,22],
[0,0,1,0,1,19],
[0,0,1,0,0,16],
[0,0,1,0,1,20],
[0,0,1,0,1,20],
[0,1,0,0,0,22],
[0,0,1,0,1,21],
[0,0,1,0,1,22],
[0,0,1,0,0,20],
[0,0,1,0,1,32],
[0,0,0,1,1,40],
[0,0,0,1,0,54],
[0,0,0,1,1,42],
[0,0,0,1,1,46],
[0,0,1,0,0,49],
[0,0,0,1,0,52],
[0,0,0,1,0,62],
[0,0,1,0,1,42],
[0,0,0,1,1,45],
[0,0,0,1,0,44],
[0,0,0,1,1,41],
[0,0,0,1,1,47],
[0,0,0,1,0,46],
[1,0,0,0,1,44],
[0,0,0,1,1,27],
[0,0,0,1,0,44],
[0,0,0,1,1,57]
    ];

var 상품데이터_결과 = [
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [1],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [2],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [3],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4],
  [4]


 
];
</script>
</head>
 
<body>
    <script>
     
        // 1. 과거의 데이터를 준비합니다. 
        var 원인 = tf.tensor(상품데이터_원인);
        var 결과 = tf.tensor(상품데이터_결과);
 
        // 2. 모델의 모양을 만듭니다. 
        var X = tf.input({ shape: [6] });
        var Y = tf.layers.dense({ units: 1 }).apply(X);
        var model = tf.model({ inputs: X, outputs: Y });
        var compileParam = { optimizer: tf.train.adam(), loss: tf.losses.meanSquaredError }
        model.compile(compileParam);
 
        // 3. 데이터로 모델을 학습시킵니다. 
//         var fitParam = {epochs: 100}
        var fitParam = { 
          epochs: 200, 
          callbacks:{
            onEpochEnd:
              function(epoch, logs){
                console.log('epoch', epoch, logs, 'RMSE=>', Math.sqrt(logs.loss));
              }
          }
        } // loss 추가 예제
        model.fit(원인, 결과, fitParam).then(function (result) {
             
            // 4. 모델을 이용합니다. 
            // 4.1 기존의 데이터를 이용

            var New상품 = [1,0,0,0,0,25]
            var New상품 = tf.tensor(New상품);
    
            
            var 예측한결과 = model.predict(New상품);
            예측한결과.print();
 
        });  
 
        // // 4.2 새로운 데이터를 이용
        //  var New상품 = [1,0,0,0,0,25]
        //  var New원인 = tf.tensor(New상품);
        //  var New결과 = model.predict(New원인);
        //  New결과.print();
    </script>
</body>
 
</html>